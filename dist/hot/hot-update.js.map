{"version":3,"file":"hot/hot-update.js","mappings":"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","sources":["webpack://kore-web-sdk/./src/components/chatwindow/chatWindow.ts","webpack://kore-web-sdk/webpack/runtime/getFullHash"],"sourcesContent":["import * as j$ from '../../libs/korejquery';\r\nimport requireKr from '../base-sdk/kore-bot-sdk-client';\r\nimport TemplateManager from '../../templatemanager/templateManager';\r\nimport KoreHelpers from '../../utils/helpers';\r\nimport EventEmitter from '../../utils/EventEmiter'\r\nimport MessageTemplate from '../../templatemanager/templates/messageTemplate/messageTemplate';\r\nimport KRPerfectScrollbar from 'perfect-scrollbar';\r\nimport './../../libs/perfectscroll/css/perfect-scrollbar.min.css';\r\nimport './sass/chatWindow.scss';\r\n//import './../../libs/emojione.sprites.css';\r\nimport chatConfig from './config/kore-config'\r\n//import GreeetingsPlugin from '../../plugins/greetings/greetings-plugin'\r\n\r\nconst bot = requireKr('/KoreBot.js').instance();\r\n\r\ndeclare const document:any;\r\nconst $:any = j$.default ;\r\ndeclare const callListener:any;\r\n\r\n\r\ndeclare const window:any;\r\n\r\n\r\n/**\r\n * ChatWindow class\r\n *\r\n * @decorator Class\r\n */\r\nclass chatWindow extends EventEmitter{\r\n chatEle: any;\r\n  config: {};\r\n\r\n\r\n   /**\r\n     * @eventProperty\r\n     */\r\n    testEvent:any;\r\n\r\n /**\r\n     * @event\r\n */\r\n  EVENTS={\r\n    /**\r\n     * jwtSuccess will be triggered once the jwt token received from API.\r\n     *\r\n     * @event chatWindow#jwtSuccess\r\n     * @type {Object}\r\n     * @property {String} jwt - jwt token from server response .\r\n     */\r\n    JWT_SUCCESS:'jwtSuccess',\r\n    /**\r\n     * beforeViewInit will be triggered before the chat window dom element is attached to provided container.\r\n     *\r\n     * @event chatWindow#beforeViewInit\r\n     * @type {object}\r\n     * @property {Object} chatEle - chat window dom element .\r\n     * @property {Object} chatWindowEvent\r\n     */\r\n    BEFORE_VIEW_INIT:'beforeViewInit',\r\n    /**\r\n     * viewInit will be triggered once the chat window dom element is attached to provided container.\r\n     *\r\n     * @event chatWindow#viewInit\r\n     * @type {object}\r\n     * @property {Object} chatEle - chat window dom element .\r\n     * @property {Object} chatWindowEvent\r\n     */\r\n    VIEW_INIT:'viewInit',\r\n    /**\r\n     * beforeRenderMessage will be triggered before appending the message html to chatwindow\r\n     *\r\n     * @event chatWindow#beforeRenderMessage\r\n     * @type {object}\r\n     * @property {Object} messageHtml message bubble html content\r\n     * @property {Object} msgData message data\r\n     * @property {Object} chatWindowEvent\r\n    */\r\n    BEFORE_RENDER_MSG:'beforeRenderMessage',\r\n     /**\r\n     * afterRenderMessage will be triggered after appending the message html to chatwindow\r\n     *\r\n     * @event chatWindow#afterRenderMessage\r\n     * @type {object}\r\n     * @property {Object} messageHtml message bubble html content\r\n     * @property {Object} msgData message data\r\n     * @property {Object} chatWindowEvent\r\n     */\r\n    AFTER_RENDER_MSG:'afterRenderMessage',\r\n    /**\r\n     * onWSOpen will be triggered on new websocket connection open\r\n     *\r\n     * @event chatWindow#onWSOpen\r\n     */\r\n    ON_WS_OPEN:'onWSOpen',\r\n     /**\r\n     * onWSMessage will be triggered on new message received from websocket\r\n     *\r\n     * @event chatWindow#onWSMessage\r\n     * @type {object}\r\n     * @property {Object} messageData - message data received from websocket\r\n     * @property {Object} chatWindowEvent\r\n     */\r\n    ON_WS_MESSAGE:'onWSMessage',\r\n    /**\r\n     * onWSMessage will be triggered on new message received from websocket\r\n     *\r\n     * @event chatWindow#beforeWSSendMessage\r\n     * @type {object}\r\n     * @property {Object} messageToBot - message data to be sent to to websocket\r\n     * @property {Object} chatWindowEvent\r\n     */\r\n     BEFORE_WS_SEND_MESSAGE:'beforeWSSendMessage',\r\n     /**\r\n     * onChatHistoryResponse will be triggered on chatHistory API response\r\n     *\r\n     * @event chatWindow#onChatHistoryResponse\r\n     * @type {object}\r\n     * @property {Object} historyResponse - chatHistory API response\r\n     * @property {Object} chatWindowEvent\r\n     */\r\n      ON_CHAT_HISTORY_RESPONSE:'onChatHistoryResponse',\r\n     /**\r\n     * onKeyDownEvent will be triggered on Keydown Event\r\n     *\r\n     * @event chatWindow#onKeyDownEvent\r\n     * @type {object}\r\n     * @property {Object} keyDownEvent \r\n     * @property {Object} chatWindowEvent\r\n     */\r\n      ON_KEY_DOWN: 'onKeyDown',\r\n      /**\r\n     * jwtGrantSuccess will be triggered on jwt grant success API response\r\n     *\r\n     * @event chatWindow#jwtGrantSuccess\r\n     * @type {object}\r\n     * @property {Object} jwtGrantSuccess -  jwt grant success API response\r\n     * @property {Object} chatWindowEvent\r\n     */\r\n       JWT_GRANT_SUCCESS : 'jwtGrantSuccess'\r\n  }\r\n  \r\n constructor(){\r\n  super(null);\r\n  this.chatEle;\r\n  this.config={};\r\n  this.init(this.config);\r\n}\r\npaginatedScrollMsgDiv: any = $('<div class=\"temp-message-div\"><ul class=\"prev-message-list\"></ul></div>');\r\ninit  (config:any) {\r\n  const me:any = this;\r\n  me.config=me.extend(me.config,chatConfig);\r\n  me.plugins = {};\r\n  me.bot=bot;\r\n  me.vars={};\r\n  me.helpers=KoreHelpers.helpers;\r\n  me.templateManager = new TemplateManager(me);\r\n  me.messageTemplate=new MessageTemplate();\r\n  me.messageTemplate.hostInstance=me;\r\n  me.installCallbackForPlugins();\r\n  me.installDefaultPlugins();\r\n}\r\n\r\ninstallDefaultPlugins(){\r\n  const me:any = this;\r\n  //me.installPlugin(new GreeetingsPlugin());\r\n}\r\n\r\ninstallCallbackForPlugins (){\r\n  const me:any = this;\r\n  Object.keys(me.plugins).forEach(function(pluginName){\r\n    if(me.plugins[pluginName].onHostCreate) { \r\n      me.plugins[pluginName].onHostCreate();\r\n    }\r\n  });\r\n}\r\n\r\n\r\nshow  (config:any) {\r\n  const me:any = this;\r\n  if (config.widgetSDKInstace) {\r\n    this.addWidgetEvents(config);\r\n  }\r\n  me.initShow(config);\r\n  if ($('body').find('.kore-chat-window').length > 0) {\r\n      return false;\r\n  }\r\n \r\n};\r\ninitShow  (config:any) {\r\n  const me:any = this;\r\n  me.config=me.extend(chatConfig,config);\r\n  this.config = me.extend(me.config,{\r\n    chatTitle: 'Kore.ai Bot Chat',\r\n    allowIframe: false,\r\n    botOptions: me.config.botOptions,\r\n  });\r\n  me.messagesQueue=[];\r\n\r\n  me.config.chatTitle = 'Kore.ai Bot Chat';\r\n  me.config.allowIframe = false;\r\n\r\n  me.reWriteWebHookURL(me.config);\r\n  window._chatHistoryLoaded = false;\r\n  me.JWTSetup();\r\n  me.initi18n();\r\n  me.seti18n((me.config && me.config.i18n && me.config.i18n.defaultLanguage) || 'en');\r\n  me.config.botOptions.botInfo.name = me.config.botOptions.botInfo.name.escapeHTML();\r\n  me._botInfo = me.config.botOptions.botInfo;\r\n  me.config.botOptions.botInfo = {\r\n    chatBot: me._botInfo.name, taskBotId: me._botInfo._id, customData: me._botInfo.customData, metaTags: me._botInfo.metaTags, tenanturl: me._botInfo.tenanturl,\r\n  };\r\n  const tempTitle = me._botInfo.name;\r\n  me.config.chatTitle = me.config.botMessages.connecting;\r\n  if (me.config.multiPageApp && me.config.multiPageApp.enable) {\r\n    var cwState = me.getLocalStoreItem('kr-cw-state');\r\n    var maintainContext:any = !!cwState;\r\n    if (maintainContext && me.getLocalStoreItem('kr-cw-uid')) {\r\n      me.config.botOptions.userIdentity = me.getLocalStoreItem('kr-cw-uid');\r\n    }\r\n    me.config.botOptions.maintainContext = maintainContext;\r\n  }\r\n  me.config.userAgentIE = navigator.userAgent.indexOf('Trident/') !== -1;\r\n  const mobileBrowserOpened = me.isMobile();\r\n  if (mobileBrowserOpened) {\r\n    me.config.isSendButton = true;\r\n  }\r\n  me.config.ttsInterface = me.config.ttsInterface || 'webapi';\r\n  me.loadHistory = me.config.loadHistory || false;\r\n  me.historyLoading = !!me.loadHistory;\r\n  me.config.botOptions.loadHistory = me.config.loadHistory;\r\n  me.config.botOptions.chatHistory = me.config.chatHistory;\r\n  me.config.botOptions.handleError = me.config.handleError;\r\n  me.config.botOptions.googleMapsAPIKey = me.config.googleMapsAPIKey;\r\n \r\n  const chatWindowHtml = (<any> $(me.getChatTemplate())).tmpl(me.config);\r\n  me.chatEle = chatWindowHtml;\r\n  me.updatei18nDirection();\r\n\r\n  me.config.chatTitle = tempTitle;\r\n  if (!me.config.minimizeMode) {\r\n    me.bot.init(me.config.botOptions, me.config.messageHistoryLimit);\r\n    // me.config.botOptions.callback(null, me.config.botOptions);\r\n    if (me.config.multiPageApp && me.config.multiPageApp.enable) {\r\n      me.setLocalStoreItem('kr-cw-state', 'open');\r\n      me.setLocalStoreItem('kr-cw-uid', me.config.botOptions.userIdentity);\r\n      setTimeout(() => {\r\n        if (cwState === 'minimized') {\r\n          $('.kore-chat-window button.minimize-btn').trigger('click');\r\n        }\r\n      }, 500);\r\n    }\r\n  } else {\r\n    chatWindowHtml.addClass('minimize');\r\n    chatWindowHtml.find('.minimized-title').html(`Talk to ${me.config.chatTitle}`);\r\n    me.skipedInit = true;\r\n    if (me.config.multiPageApp && me.config.multiPageApp.enable && maintainContext) {\r\n      setTimeout(() => {\r\n        if (cwState === 'open') {\r\n          $('.kore-chat-window .minimized .messages').trigger('click');\r\n        } else if (cwState === 'minimized') {\r\n          $('.kore-chat-window .minimized .messages').trigger('click');\r\n          $('.kore-chat-window button.minimize-btn').trigger('click');\r\n        }\r\n      }, 500);\r\n    }\r\n  }\r\n  if (me.config.allowLocation) {\r\n    me.bot.fetchUserLocation();\r\n  }\r\n  me.render(chatWindowHtml);\r\n  me.unfreezeUIOnHistoryLoadingFail.call(me);\r\n  me.updateOnlineStatus();\r\n  me.addBottomSlider();\r\n  window.addEventListener('online', me.updateOnlineStatus);\r\n  window.addEventListener('offline', me.updateOnlineStatus);\r\n  me.attachEventListener();\r\n  // me.show();\r\n};\r\n\r\nfindSortedIndex  (array:any, value:any) {\r\n  let low = 0;\r\n  let high = array.length;\r\n\r\n  while (low < high) {\r\n    const mid = (low + high) >>> 1;\r\n    if (array[mid] < value) low = mid + 1;\r\n    else high = mid;\r\n  }\r\n  return low;\r\n};\r\n\r\nextend(target:any, source:any) {\r\n  let me:any=this;\r\n  for (var prop in source) {\r\n      if (source.hasOwnProperty(prop)) {\r\n          if (target[prop] && typeof source[prop] === 'object') {\r\n              me.extend(target[prop], source[prop]);\r\n          }\r\n          else {\r\n              target[prop] = source[prop];\r\n          }\r\n      }\r\n  }\r\n  return target;\r\n}\r\n\r\n// converts v1 webhooks url to v2 automatically\r\nreWriteWebHookURL  (chatConfig:any) {\r\n  if (chatConfig.botOptions && chatConfig.botOptions.webhookConfig && chatConfig.botOptions.webhookConfig.apiVersion && chatConfig.botOptions.webhookConfig.apiVersion === 2) {\r\n    if (chatConfig.botOptions && chatConfig.botOptions.webhookConfig && chatConfig.botOptions.webhookConfig.webhookURL) {\r\n      chatConfig.botOptions.webhookConfig.webhookURL = chatConfig.botOptions.webhookConfig.webhookURL.replace('hooks', 'v2/webhook');\r\n    }\r\n  }\r\n};\r\n// iframe of child window events //\r\nattachEventListener (iframe:any, postPayload:any) {\r\n  if (iframe && iframe.length && iframe[0] && iframe[0].contentWindow && postPayload) {\r\n    iframe[0].contentWindow.postMessage(postPayload, '*');\r\n  }\r\n}\r\npostMessageToChildIframes (iframe: any,postPayload: any) {\r\n  if(iframe && iframe.length && iframe[0] && iframe[0].contentWindow && postPayload){\r\n      iframe[0].contentWindow.postMessage(\r\n          postPayload, '*'\r\n    );\r\n  }\r\n};\r\n// iframe of child window events ends//\r\n\r\n// inline model for iframes starts here//\r\nopenModal(template:any, showClose:any) {\r\n  let me:any=this;\r\n  const chatBodyModal = $('#chatBodyModal');\r\n  const close = (<any> document).getElementsByClassName('closeChatBodyModal')[0];\r\n  close.onclick = function () {\r\n    $('.kore-chat-window').removeClass('modelOpen');\r\n    const postPayload = {\r\n      payload: {},\r\n      event: 'formEvent', // need to find another way to make it common ,giving a static value due to time constrain //\r\n      action: 'formCancel',\r\n      metaData: {},\r\n    };\r\n    const iframe = chatBodyModal.find('iframe');\r\n    me.postMessageToChildIframes(iframe, postPayload);\r\n    chatBodyModal.hide();\r\n    $('.kore-chat-window').removeClass('modelOpen');\r\n  };\r\n  if (template) {\r\n    chatBodyModal.find('.closeChatBodyModal').css('display', 'none');\r\n    chatBodyModal.find('.loading_form').css('z-index', 999);\r\n    if (chatBodyModal && chatBodyModal.length) {\r\n      chatBodyModal.find('#chatBodyModalContent').empty();\r\n      chatBodyModal.find('#chatBodyModalContent').append(template);\r\n      chatBodyModal.show();\r\n      $('.kore-chat-window').addClass('modelOpen');\r\n    }\r\n    setTimeout(() => {\r\n      chatBodyModal.find('.loading_form').css('z-index', 0);\r\n      if (showClose) {\r\n        chatBodyModal.find('.closeChatBodyModal').css('display', 'block');\r\n      } else {\r\n        chatBodyModal.find('.closeChatBodyModal').css('display', 'none');\r\n      }\r\n    }, 1500);\r\n  } else {\r\n    $('.kore-chat-window').removeClass('modelOpen');\r\n    chatBodyModal.find('.closeChatBodyModal').css('display', 'none');\r\n    setTimeout(() => {\r\n      chatBodyModal.find('#chatBodyModalContent').empty();\r\n    }, 1000);\r\n    chatBodyModal.hide();\r\n    $('.kore-chat-window').removeClass('modelOpen');\r\n  }\r\n}\r\n// inline model for iframes starts ends//\r\n\r\n// form event actions starts here //\r\nformAction(event:any) {\r\n  let me:any=this;\r\n  if (event && event.action === 'formSubmit') {\r\n    me.openModal();\r\n    if ($('.kore-chat-body .uiformComponent').length) {\r\n      $('.kore-chat-body .uiformComponent').closest('.inlineIframeContainer').css('display', 'none');\r\n    }\r\n  } else if (event.action === 'formCancel') {\r\n    if ($('.kore-chat-body .uiformComponent').length) {\r\n      $('.kore-chat-body .uiformComponent').closest('.inlineIframeContainer').css('display', 'none');\r\n    }\r\n  } else if (event.action === 'formClose') {\r\n    me.openModal();\r\n    if ($('.kore-chat-body .uiformComponent').length) {\r\n      $('.kore-chat-body .uiformComponent').closest('.inlineIframeContainer').css('display', 'none');\r\n    }\r\n  }\r\n}\r\nrenderWebForm  (msgData:any, returnTemplate:any) {\r\n  const me:any = this;\r\n  if (msgData.message && msgData.message[0].component && msgData.message[0].component.payload && msgData.message[0].component.payload.formData) {\r\n    msgData.renderType = msgData.message[0].component.payload.formData.renderType;\r\n    msgData.message[0].component.payload.template_type = 'iframe';\r\n    if (!returnTemplate && msgData.renderType === 'inline') {\r\n      this.renderMessage(msgData);\r\n    } else {\r\n      // const popupHtml = $(this.getChatTemplate('iframe')).tmpl({\r\n      //   msgData,\r\n      //   helpers: me.helpers,\r\n      //   link_url: msgData.message[0].component.payload.formData.formLink,\r\n      // });\r\n      const popupHtml =  me.templateManager.renderMessage(msgData)\r\n      if (returnTemplate) {\r\n        return popupHtml;\r\n      }\r\n      me.openModal(popupHtml[0], true);\r\n    }\r\n  }\r\n};\r\n// form event actions ends here //\r\naddBottomSlider  () {\r\n  $('.kore-chat-window').remove('.kore-action-sheet');\r\n  const actionSheetTemplate = '<div class=\"kore-action-sheet hide\">\\\r\n <div class=\"actionSheetContainer\"></div>\\\r\n </div>';\r\n  $('.kore-chat-window').append(actionSheetTemplate);\r\n};\r\nupdateOnlineStatus () {\r\n  let me:any=this;\r\n  if (typeof (navigator.onLine) === 'boolean') {\r\n    if (navigator.onLine) {\r\n      me.hideError();\r\n      if (bot && bot.RtmClient) {\r\n        bot.getHistory({ forHistorySync: true, limit: 30 });\r\n      }\r\n    } else {\r\n      me.showError('You are currently offline');\r\n    }\r\n  }\r\n};\r\n\r\nresetPingMessage  () {\r\n  const me:any = this;\r\n  clearTimeout(me.config.pingPong.timer);\r\n  me.config.pingPong.timer = setTimeout(() => {\r\n    const messageToBot:any = {};\r\n    messageToBot.type = 'ping';\r\n    me.bot.sendMessage(messageToBot, () => {\r\n\r\n    });\r\n    me.resetPingMessage();\r\n  }, me.config.pingPong.interval);\r\n};\r\n\r\nhandleImagePreview  () {\r\n  const modal = document.getElementById('myModal');\r\n\r\n  // Get the image and insert it inside the modal - use its \"alt\" text as a caption\r\n  //const img = document.getElementById('myImg');\r\n  const modalImg = document.getElementById('img01');\r\n  const captionText = document.getElementById('caption');\r\n  if (document.querySelectorAll('.messageBubble img').length > 0) {\r\n    for (let i = 0; i < document.querySelectorAll('.messageBubble img').length; i++) {\r\n      const evt = document.querySelectorAll('.messageBubble img')[i];\r\n      evt.addEventListener('click',  (e:any) => {\r\n        e.stopPropagation();\r\n        e.stopImmediatePropagation();\r\n        modal.style.display = 'block';\r\n        modalImg.src = $(e.currentTarget).attr('src');\r\n        captionText.innerHTML = $(e.currentTarget).attr('alt');\r\n      });\r\n    }\r\n  }\r\n\r\n  /* img.onclick = function(){\r\n         modal.style.display = \"block\";\r\n         modalImg.src = this.src;\r\n         captionText.innerHTML = this.alt;\r\n     } */\r\n\r\n  // Get the <span> element that closes the modal\r\n  const span = document.getElementsByClassName('closeImagePreview')[0];\r\n\r\n  // When the user clicks on <span> (x), close the modal\r\n  span.onclick = function () {\r\n    modal.style.display = 'none';\r\n  };\r\n};\r\nisMobile () {\r\n  try {\r\n    const isMobile = (/iphone|ipod|android|blackberry|fennec/).test(navigator.userAgent.toLowerCase()) || window.screen.width <= 480;\r\n    return isMobile;\r\n  } catch (e) {\r\n    return false;\r\n  }\r\n};\r\nonWindowResize (event:any) {\r\n  let me:any=this;\r\n    $('.chat-container').scrollTop($('.chat-container')[0].scrollHeight);\r\n    if (me.chatPSObj && me.chatPSObj.update) {\r\n      me.chatPSObj.update();\r\n    }\r\n};\r\nsetLocalStoreItem  (key:any, value:any) {\r\n  const me:any = this;\r\n  const storage = me.getStoreTypeByKey(key);\r\n  return window[storage].setItem(key, value);\r\n};\r\ngetLocalStoreItem  (key:any) {\r\n  const me:any = this;\r\n  const storage = me.getStoreTypeByKey(key);\r\n  return window[storage].getItem(key);\r\n};\r\nremoveLocalStoreItem (key:any) {\r\n  const me:any = this;\r\n  const storage = me.getStoreTypeByKey(key);\r\n  return window[storage].removeItem(key);\r\n};\r\ngetStoreTypeByKey (key:any) {\r\n  const me:any = this;\r\n  let storage = 'localStorage';\r\n  if (key === 'kr-cw-uid') {\r\n    storage = me.config.multiPageApp.chatWindowStateStore;\r\n  } else if (key === 'kr-cw-uid') {\r\n    storage = me.config.multiPageApp.userIdentityStore;\r\n  }\r\n  return storage;\r\n};\r\n\r\niniti18n  () {\r\n  const me:any = this;\r\n  me.i18n = {\r\n    selectedLanguage: 'en',\r\n    rtlLanguages: [], // loads from i18n config\r\n    langFiles: {\r\n      en: {\r\n        message: 'Message...',\r\n        connecting: 'Connecting...',\r\n        reconnecting: 'Reconnecting...',\r\n        entertosend: 'Press enter to send',\r\n        endofchat: 'End of chat history',\r\n        loadinghistory: 'Loading chat history..',\r\n        sendText: 'Send',\r\n        closeText: 'Close',\r\n        expandText: 'Expand',\r\n        minimizeText: 'Minimize',\r\n        reconnectText: 'Reconnect',\r\n        attachmentText: 'Attachment',\r\n      },\r\n    },\r\n  };\r\n  if (me.plugins.Korei18nPlugin) {\r\n    me.config.i18n = me.plugins.Korei18nPlugin.config;\r\n  }\r\n  if (me.config && me.config.i18n && me.config.i18n.languageStrings) {\r\n    me.i18n.langFiles = me.extend(me.i18n.langFiles, me.config.i18n.languageStrings);\r\n  }\r\n  if (me.config && me.config.i18n && me.config.i18n.rtlLanguages) {\r\n    me.i18n.rtlLanguages = me.extend(me.i18n.rtlLanguages, me.config.i18n.rtlLanguages);\r\n  }\r\n};\r\nseti18n (lang:any) {\r\n  const me:any = this;\r\n  let botMessages;\r\n  me.i18n.selectedLanguage = lang;\r\n  botMessages=me.config.botMessages  = me.i18n.langFiles[me.i18n.selectedLanguage];\r\n  botMessages.availableLanguages = (me.config.i18n && me.config.i18n.availableLanguages) || false;\r\n  botMessages.selectedLanguage = me.i18n.selectedLanguage;\r\n\r\n  if (me.chatEle) {\r\n    const chatEle = me.chatEle;\r\n    chatEle.find('.endChatContainerText').html(botMessages.endofchat);\r\n\r\n    chatEle.find('.close-btn').attr('title', botMessages.closeText);\r\n    chatEle.find('.expand-btn').attr('title', botMessages.expandText);\r\n    chatEle.find('.minimize-btn').attr('title', botMessages.minimizeText);\r\n    chatEle.find('.reload-btn').attr('title', botMessages.reconnectText);\r\n    chatEle.find('.sdkAttachment.attachmentBtn').attr('title', botMessages.attachmentText);\r\n\r\n    chatEle.find('.chatInputBox').attr('placeholder', botMessages.message);\r\n    chatEle.find('.sendButton').html(botMessages.sendText);\r\n    chatEle.find('.chatSendMsg').html(botMessages.entertosend);\r\n  }\r\n};\r\nupdatei18nDirection () {\r\n  const me:any = this;\r\n  if (me.i18n.rtlLanguages.indexOf(me.i18n.selectedLanguage) > -1) {\r\n    me.chatEle.attr('dir', 'rtl');\r\n  } else {\r\n    me.chatEle.attr('dir', 'ltr');\r\n  }\r\n};\r\ndestroy  () {\r\n  const me:any = this;\r\n  $('.kore-chat-overlay').hide();\r\n  me.bot.close();\r\n  if (!me.config.minimizeMode) {\r\n    me.bot.destroy();\r\n  }\r\n  me.messagesQueue = [];\r\n  if (me.config && me.chatEle) {\r\n    if (!me.config.minimizeMode) {\r\n      me.chatEle.remove();\r\n    } else {\r\n      me.chatEle.find('.kore-chat-header .header-title').html(me.config.botMessages.reconnecting);\r\n      me.chatEle.addClass('minimize');\r\n      me.skipedInit = true;\r\n    }\r\n  }\r\n  window.removeEventListener('online', me.updateOnlineStatus);\r\n  window.removeEventListener('offline', me.updateOnlineStatus);\r\n};\r\n\r\nresetWindow () {\r\n  const me:any = this;\r\n  me.chatEle.find('.kore-chat-header .header-title').html(me.config.botMessages.reconnecting);\r\n  // me.chatEle.find('.chat-container').html(\"\");\r\n  me.bot.close();\r\n  me.config.botOptions.maintainContext = false;\r\n  me.setLocalStoreItem('kr-cw-uid', me.config.botOptions.userIdentity);\r\n  me.bot.init(me.config.botOptions);\r\n};\r\n\r\nsendMessageWithWithChatInput(chatInput:any){\r\n  let me:any=this;\r\n  if (chatInput.text().trim() === '') {\r\n    return;\r\n  }\r\n  me.sendMessageToBot(chatInput.text());\r\n  chatInput.html(chatInput.html().replaceAll('<br>', '\\n'));\r\n  chatInput.html('');\r\n}\r\nbindEvents  () {\r\n  const me:any = this;\r\n  const _chatContainer = me.chatEle;\r\n  window.onresize = function (event:any) {\r\n    me.onWindowResize(event);\r\n  };\r\n  window.onbeforeunload = function () {\r\n    if (me && $(me.chatEle).length > 0) {\r\n      me.destroy();\r\n    }\r\n  };\r\n  _chatContainer.on('keyup', '.chatInputBox',  (event:any) => {\r\n    const _footerContainer = $(me.config.container).find('.kore-chat-footer');\r\n    const _bodyContainer = $(me.config.container).find('.kore-chat-body');\r\n    _bodyContainer.css('bottom', _footerContainer.outerHeight());\r\n    me.prevComposeSelection = window.getSelection();\r\n    me.prevRange = me.prevComposeSelection.rangeCount > 0 && me.prevComposeSelection.getRangeAt(0);\r\n    if (event.currentTarget.innerText.length > 0) {\r\n      _chatContainer.find('.chatInputBoxPlaceholder').css('display', 'none');\r\n      _chatContainer.find('.sendButton').removeClass('disabled');\r\n    } else {\r\n      _chatContainer.find('.chatInputBoxPlaceholder').css('display', 'block');\r\n      _chatContainer.find('.sendButton').addClass('disabled');\r\n    }\r\n  });\r\n  _chatContainer.on('click', '.chatInputBoxPlaceholder', () => {\r\n    _chatContainer.find('.chatInputBox').trigger('click');\r\n    _chatContainer.find('.chatInputBox').trigger('focus');\r\n  });\r\n  _chatContainer.on('change', '.lang-selector', (e: { target: any; }) => {\r\n    const selectedValue = $(e.target).val();\r\n    me.seti18n(selectedValue);\r\n    me.updatei18nDirection();\r\n  });\r\n  _chatContainer.on('click', '.chatInputBox', () => {\r\n    me.prevComposeSelection = window.getSelection();\r\n    me.prevRange = me.prevComposeSelection.rangeCount > 0 && me.prevComposeSelection.getRangeAt(0);\r\n  });\r\n  _chatContainer.on('keydown', '.chatInputBox',  (event:any) => {\r\n    const chatInput:any = $(event.currentTarget);\r\n    let chatWindowEvent = {stopFurtherExecution: false};\r\n    me.emit(me.EVENTS.ON_KEY_DOWN,{\r\n      event:event,\r\n      chatWindowEvent: chatWindowEvent\r\n    });\r\n    if(chatWindowEvent.stopFurtherExecution){\r\n      return false;\r\n    }\r\n    const _footerContainer = $(me.config.container).find('.kore-chat-footer');\r\n    const _bodyContainer = $(me.config.container).find('.kore-chat-body');\r\n    _bodyContainer.css('bottom', _footerContainer.outerHeight());\r\n    if (event.keyCode === 13) {\r\n      if (event.shiftKey) {\r\n        return;\r\n      }\r\n      event.preventDefault();\r\n      me.sendMessageWithWithChatInput(chatInput);\r\n    } \r\n  });\r\n\r\n  _chatContainer.on('click', '.sendButton', (event: { preventDefault: () => void; }) => {\r\n    const chatInput:any =  _chatContainer.find('.chatInputBox');\r\n    event.preventDefault();\r\n    me.sendMessageWithWithChatInput(chatInput);\r\n  });\r\n  \r\n  _chatContainer.on('click', '.sendChat', (event: any) => {\r\n    const _footerContainer = $(me.config.container).find('.kore-chat-footer');\r\n    me.sendMessageWithWithChatInput(_footerContainer.find('.chatInputBox'));\r\n  });\r\n\r\n  _chatContainer.on('click', 'li a',  (e: any) => {\r\n    e.preventDefault();\r\n    const a_link = $(this).attr('href');\r\n    const _trgt = $(this).attr('target');\r\n    const msgDataText = $(e.currentTarget).closest('span.simpleMsg').attr('msgData') || '';\r\n    let msgData;\r\n    if (msgDataText) {\r\n      try {\r\n        msgData = JSON.parse(msgDataText);\r\n      } catch (err) {\r\n\r\n      }\r\n    }\r\n    if (msgData && msgData.message && msgData.message[0].component && msgData.message[0].component.payload && msgData.message[0].component.payload.formData) {\r\n      me.renderWebForm(msgData);\r\n    } else if (_trgt === '_self') {\r\n      callListener('provideVal', { link: a_link });\r\n      return;\r\n    }\r\n    if (me.config.allowIframe === true) {\r\n      const popupHtml = $(me.getChatTemplate('iframe')).tmpl({\r\n        msgData,\r\n        helpers: me.helpers,\r\n        link_url: URL,\r\n      });\r\n      popupHtml[0].onload = function (iFrameEvent: any) {\r\n        console.log(iFrameEvent);\r\n      };\r\n      me.openModal(popupHtml[0], true);\r\n    } else {\r\n      me.openExternalLink(a_link);\r\n    }\r\n  });\r\n  \r\n  _chatContainer.on('click', '.close-btn', (event: any) => {\r\n    me.destroy();\r\n    bot.historyOffset = 0;\r\n    bot.previousHistoryLoading = false;\r\n    if (me.config.multiPageApp && me.config.multiPageApp.enable) {\r\n      me.removeLocalStoreItem('kr-cw-state');\r\n      me.removeLocalStoreItem('kr-cw-uid');\r\n      me.config.botOptions.maintainContext = false;\r\n    }\r\n  });\r\n\r\n  _chatContainer.on('click', '.minimize-btn', (event: any) => {\r\n    if (me.config.multiPageApp && me.config.multiPageApp.enable) {\r\n      me.setLocalStoreItem('kr-cw-state', 'minimized');\r\n    }\r\n    if (me.minimized === true) {\r\n      _chatContainer.removeClass('minimize');\r\n      me.minimized = false;\r\n    } else {\r\n      _chatContainer.addClass('minimize');\r\n      _chatContainer.find('.minimized-title').html(`Talk to ${me.config.chatTitle}`);\r\n      me.minimized = true;\r\n      if (me.expanded === true) {\r\n        $('.kore-chat-overlay').hide();\r\n      }\r\n    }\r\n  });\r\n\r\n  _chatContainer.off('click', '.expand-btn').on('click', '.expand-btn',  (event: any) => {\r\n    if (me.expanded === true) {\r\n      $(this).attr('title', 'Expand');\r\n      _chatContainer.removeClass('expanded');\r\n      $('.expand-btn-span').removeClass('fa-compress');\r\n      $('.expand-btn-span').addClass('fa-expand');\r\n      me.expanded = false;\r\n      $('.chat-container').scrollTop($('.chat-container')[0].scrollHeight);\r\n    } else {\r\n      $(this).attr('title', 'Collapse');\r\n      _chatContainer.addClass('expanded');\r\n      $('.expand-btn-span').addClass('fa-compress');\r\n      $('.expand-btn-span').removeClass('fa-expand');\r\n      me.expanded = true;\r\n    }\r\n    const evt = document.createEvent('HTMLEvents');\r\n    evt.initEvent('resize', true, false);\r\n    window.dispatchEvent(evt);\r\n    const container_pos_left = _chatContainer.position().left + _chatContainer.width();\r\n    if (container_pos_left > $(window).width()) {\r\n      _chatContainer.css('left', `${_chatContainer.position().left - (container_pos_left - $(window).width() + 10)}px`);\r\n    }\r\n    if (me.chatPSObj && me.chatPSObj.update) {\r\n      me.chatPSObj.update();\r\n    }\r\n  });\r\n\r\n  $(document).on('keyup', (evt: { keyCode: number; }) => {\r\n    if (evt.keyCode == 27) {\r\n      $('.closeImagePreview').trigger('click');\r\n      $('.closeElePreview').trigger('click');\r\n    }\r\n  });\r\n  \r\n  _chatContainer.on('click', '.minimized,.minimized-title', (event: any) => {\r\n    if (me.config.multiPageApp && me.config.multiPageApp.enable) {\r\n      me.setLocalStoreItem('kr-cw-state', 'open');\r\n    }\r\n    _chatContainer.removeClass('minimize');\r\n    me.minimized = false;\r\n    if (me.skipedInit) {\r\n      if (me.config.multiPageApp && me.config.multiPageApp.enable) {\r\n        me.setLocalStoreItem('kr-cw-uid', me.config.botOptions.userIdentity);\r\n      }\r\n      me.bot.init(me.config.botOptions, me.config.messageHistoryLimit);\r\n      me.skipedInit = false;\r\n    }\r\n    const evt = document.createEvent('HTMLEvents');\r\n    evt.initEvent('resize', true, false);\r\n    $('.chat-container').animate({\r\n      scrollTop: $('.chat-container').prop('scrollHeight'),\r\n    }, 100);\r\n  });\r\n\r\n  _chatContainer.on('click', '.reload-btn',  (event: any) => {\r\n    me.config.botOptions.forceReconnecting = false;// make it to true if reconnect button should not trigger on connect message\r\n    $(this).addClass('disabled').prop('disabled', true);\r\n    $('.close-btn').addClass('disabled').prop('disabled', true);\r\n    setTimeout(() => {\r\n      me.resetWindow();\r\n    });\r\n  });\r\n  if (me?.config?.history?.paginatedScroll?.enable) {\r\n    _chatContainer.find('.kore-chat-body .chat-container').on('scroll', (event: any) => {\r\n      var div = $(event.currentTarget);\r\n      if (div[0].scrollHeight - div.scrollTop() == div.height()) {\r\n        bot.previousHistoryLoading = false;\r\n      }\r\n      else if (div.scrollTop() == 0) {\r\n        if (bot.paginatedScrollDataAvailable) {\r\n          bot.previousHistoryLoading = true;\r\n          let message = me?.config?.history?.paginatedScroll?.loadingLabel || 'Loading chat history..';\r\n          let paginatedHistoryLoader = $('<div class=\"paginted-history-loader\">\\\r\n                                              <div class=\"historyWarningTextDiv displayTable\">  \\\r\n                                                <span><img class=\"loadingHistory\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAAXNSR0IArs4c6QAAAYZJREFUOBGtVLFKA0EQfbMiiERQEgjpRQt/wULB/opIFCuJvb1iKdprbbASDaa4L9DCX7BQ7CVwQcEggph13t7t3RlivMKBsDsz701mZ9+eYNjaNyX0e9saDmCxZJv1mrQ6zxDcayxEqXyOxmo/TzN5B2fXDbxFT7D2VH9rgK3FeV3pM848cTnLirQ6e0q60lw1lx+11bziHD5Oi1tcZVfAkyIYOYRM3GF69gHvr4uwX8sY2AMFVDwIkA3srLcFnAFb9B2I3GJqchNbQTcDJ7uLsIqPz0s91koS6WKmMm+SIfojRL8WIIuF+QdAlBSpks+ZBEkA7gijOkgBumGeR80sMLzG1OcMilgep3wDseWUxyEWsTnzmMKUr51ILw3wForYy2AhhSlfO3FKjGO8xiKWxymfgw1THnXAaxxnzMd68ajQuLcAeE1UnA5+K+R1kgmuS/4/KdY3xbdgB0fe/XMVs49m/Zi4uBPPiN/Qibrj5qJHl12+GU/7WYTRoe+J0xFlMOZ78g1n4achujvX7QAAAABJRU5ErkJggg==\"></span>                \\\r\n                                                <p class=\"headerTip warningTip\">'+ message + '</p>\\\r\n                                                </div>\\\r\n                                            </div>');\r\n          if (!(_chatContainer.find('.paginted-history-loader').length)) {\r\n            $(paginatedHistoryLoader).insertBefore(_chatContainer.find('.chat-container li:first'));\r\n          }\r\n          bot.getHistory({ limit: (me?.config?.history?.paginatedScroll?.batchSize) });\r\n        }\r\n      }\r\n    });\r\n  }\r\n  me.bindSDKEvents();\r\n};\r\n\r\ngetBotMetaData  () {\r\n  const me:any = this;\r\n  me.bot.getBotMetaData((res: any) => {\r\n    me.sendWebhookOnConnectEvent();\r\n  }, (errRes: any) => {\r\n    me.sendWebhookOnConnectEvent();\r\n  });\r\n};\r\nsendWebhookOnConnectEvent  () {\r\n  const me:any = this;\r\n  me.sendMessageViaWebHook({\r\n    type: 'event',\r\n    val: 'ON_CONNECT',\r\n  }, (msgsData: any) => {\r\n    me.onBotReady();\r\n    me.handleWebHookResponse(msgsData);\r\n  }, () => {\r\n    me.onBotReady();\r\n    console.log('Kore:error sending on connect event');\r\n  }, {\r\n    session: {\r\n      new: true,\r\n    },\r\n  });\r\n};\r\n\r\nbindSDKEvents  () {\r\n  // hook to add custom events\r\n  const me:any = this;\r\n  let chatWindowEvent = {stopFurtherExecution: false};\r\n  me.bot.on('open', (response: any) => {\r\n    me.emit(me.EVENTS.ON_WS_OPEN, {messageData:\"\",chatWindowEvent:chatWindowEvent});\r\n    if(chatWindowEvent.stopFurtherExecution){\r\n      return false;\r\n    }\r\n    me.onBotReady();\r\n  });\r\n\r\n  me.bot.on('message', (response: { data: string; }) => {\r\n    // actual implementation starts here\r\n    if (me.popupOpened === true) {\r\n      $('.kore-auth-popup .close-popup').trigger('click');\r\n    }\r\n\r\n    let tempData = JSON.parse(response.data);\r\n    let chatWindowEvent = {stopFurtherExecution: false};\r\n    me.emit(me.EVENTS.ON_WS_MESSAGE,{\r\n      messageData:tempData,\r\n      chatWindowEvent:chatWindowEvent\r\n    });\r\n    if(chatWindowEvent.stopFurtherExecution){\r\n      return false;\r\n    }\r\n\r\n    let msgData=me.parseSocketMessage(response.data);\r\n    if (me.loadHistory && me.historyLoading) {\r\n        me.messagesQueue.push(msgData)\r\n    } else {\r\n        if (me.config.supportDelayedMessages) {\r\n            me.pushTorenderMessagesQueue(msgData)\r\n        } else {\r\n            me.renderMessage(msgData)\r\n        }\r\n    }\r\n    // if (msgData.type === 'appInvalidNotification') {\r\n    //   setTimeout(() => {\r\n    //     $('.trainWarningDiv').addClass('showMsg');\r\n    //   }, 2000);\r\n    // }\r\n  });\r\n\r\n  me.bot.on('webhook_ready', (response: any) => {\r\n    if (!me.config.loadHistory) {\r\n      me.getBotMetaData();\r\n    }\r\n  });\r\n\r\n  me.bot.on('webhook_reconnected', (response: any) => {\r\n    me.onBotReady();\r\n  });\r\n\r\n  me.bot.on('jwtgrantsuccess', (response: { jwtgrantsuccess: any; }) => {\r\n    me.config.jwtGrantSuccessInformation = response.jwtgrantsuccess;\r\n    me.getBrandingInformation(response.jwtgrantsuccess);\r\n    me.emit(me.EVENTS.JWT_GRANT_SUCCESS, response.jwtgrantsuccess);\r\n  });\r\n};\r\nparseSocketMessage(msgString:string){\r\n  let me:any=this;\r\n  let msgData;\r\n  let tempData= JSON.parse(msgString);\r\n  if (tempData.from === 'bot' && tempData.type === 'bot_response') {\r\n    if (tempData && tempData.message && tempData.message.length) {\r\n      if (tempData.message[0]) {\r\n        if (!tempData.message[0].cInfo) {\r\n          tempData.message[0].cInfo = {};\r\n        }\r\n        if (tempData.message[0].component && !tempData.message[0].component.payload.text) {\r\n          try {\r\n            tempData.message[0].component = JSON.parse(tempData.message[0].component.payload);\r\n          } catch (err) {\r\n            tempData.message[0].component = tempData.message[0].component.payload;\r\n          }\r\n        }\r\n        if (tempData.message[0].component && tempData.message[0].component.payload && tempData.message[0].component.payload.text) {\r\n          tempData.message[0].cInfo.body = tempData.message[0].component.payload.text;\r\n        }\r\n        if (tempData.message[0].component && tempData.message[0].component.payload && (tempData.message[0].component.payload.videoUrl || tempData.message[0].component.payload.audioUrl)) {\r\n          tempData.message[0].cInfo.body = tempData.message[0].component.payload.text || '';\r\n        }\r\n      }\r\n    }\r\n    msgData=tempData;\r\n  } else if (tempData.from === 'self' && tempData.type === 'user_message') {\r\n    const tempmsg = tempData.message;\r\n    if (tempmsg && tempmsg.attachments && tempmsg.attachments[0] && tempmsg.attachments[0].fileId) {\r\n      msgData = {\r\n        type: 'currentUser',\r\n        message: [{\r\n          type: 'text',\r\n          cInfo: { body: tempmsg.body, attachments: tempmsg.attachments },\r\n          clientMessageId: tempData.id,\r\n        }],\r\n        createdOn: tempData.id,\r\n      };\r\n    } else {\r\n      msgData = {\r\n        type: 'currentUser',\r\n        message: [{\r\n          type: 'text',\r\n          cInfo: { body: tempmsg.body },\r\n          clientMessageId: tempData.id,\r\n        }],\r\n        createdOn: tempData.id,\r\n      };\r\n    }\r\n    //me.renderMessage(msgData);\r\n  }\r\n  return msgData;\r\n}\r\n\r\nonBotReady  () {\r\n  // hook to add custom events\r\n  const me:any = this;\r\n  const _chatContainer = me.chatEle;\r\n  // actual implementation starts here\r\n  me.accessToken = me.config.botOptions.accessToken;\r\n  const _chatInput = _chatContainer.find('.kore-chat-footer .chatInputBox');\r\n  _chatContainer.find('.kore-chat-header .header-title').html(me.config.chatTitle).attr('title', me.config.chatTitle);\r\n  _chatContainer.find('.kore-chat-header .disabled').prop('disabled', false).removeClass('disabled');\r\n  if (!me.loadHistory) {\r\n    setTimeout(() => {\r\n      _chatContainer.find('.chatInputBox').focus();\r\n      _chatContainer.find('.disableFooter').removeClass('disableFooter');\r\n    });\r\n  }\r\n};\r\nbindIframeEvents  (authPopup: { on: (arg0: string, arg1: string, arg2: () => void) => void; find: (arg0: string) => any[]; }) {\r\n  const me:any = this;\r\n  authPopup.on('click', '.close-popup',  () => {\r\n    $(this).closest('.kore-auth-popup').remove();\r\n    $('.kore-auth-layover').remove();\r\n    me.popupOpened = false;\r\n  });\r\n\r\n  const ifram = authPopup.find('iframe')[0];\r\n\r\n  ifram.addEventListener('onload',  () => {\r\n    console.log(this);\r\n  }, true);\r\n};\r\n\r\n\r\nrender  (chatWindowHtml: any) {\r\n  const me:any = this;\r\n  let chatWindowEvent = {stopFurtherExecution: false};\r\n  me.emit(me.EVENTS.BEFORE_VIEW_INIT,{chatEle:chatWindowHtml,chatWindowEvent:chatWindowEvent});\r\n  me.bindEvents();\r\n  $(me.config.container).append(chatWindowHtml);\r\n  me.emit(me.EVENTS.VIEW_INIT,{chatEle:chatWindowHtml,chatWindowEvent:chatWindowEvent});\r\n  if(chatWindowEvent.stopFurtherExecution){\r\n    return false;\r\n  }\r\n  if (me.config.container !== 'body') {\r\n    $(me.config.container).addClass('pos-relative');\r\n    $(me.chatEle).addClass('pos-absolute');\r\n  }\r\n  if (me.config.widgetSDKInstace) {\r\n    me.chatEle.find('.kr-wiz-menu-chat').show();\r\n  }\r\n  me.chatPSObj = new KRPerfectScrollbar(me.chatEle.find('.chat-container').get(0), {\r\n    suppressScrollX: true,\r\n  });\r\n};\r\n\r\n\r\n\r\nsendMessageToBot  (messageText: { trim: () => { (): any; new(): any; length: any; }; }, options: { renderMsg: any; }, serverMessageObject: any,clientMessageObject: any) {\r\n  const me:any = this;\r\n  const clientMessageId = new Date().getTime();\r\n  let msgData:any = {\r\n    type: 'currentUser',\r\n    message: [{\r\n      type: 'text',\r\n      cInfo: { \r\n        body: messageText,\r\n        // 'attachments': serverMessageObject.message.attachments \r\n      },\r\n      clientMessageId,\r\n    }],\r\n    createdOn: clientMessageId,\r\n  };\r\n  let messageToBot:any = {\r\n    clientMessageId:clientMessageId,\r\n    resourceid :'/bot.message',\r\n  };\r\nif(messageText.trim().length){\r\n  messageToBot[\"message\"] = { \r\n    body: messageText.trim()\r\n  }\r\n}\r\n  \r\n\r\n  if (options && options.renderMsg && typeof options.renderMsg === 'string') {\r\n    msgData.message[0].cInfo.body = options.renderMsg;\r\n    messageToBot.message.renderMsg = options.renderMsg;\r\n  }\r\n\r\n  if(serverMessageObject){\r\n    me.extend(messageToBot,serverMessageObject);\r\n  }\r\n  // if (msgObject && msgObject.customdata) {\r\n  //   messageToBot.message.customdata = msgObject.customdata;\r\n  // }\r\n  // if (msgObject && msgObject.metaTags) {\r\n  //   messageToBot.message.metaTags = msgObject.metaTags;\r\n  // }\r\n\r\n  // if (msgObject && (msgObject.nlmeta || msgObject.nlMeta)) {\r\n  //   messageToBot.message.nlMeta = msgObject.nlmeta || msgObject.nlMeta;\r\n  // }\r\n  if (me.config && me.config && me.config.botOptions && me.config.botOptions.webhookConfig && me.config.botOptions.webhookConfig.enable) {\r\n    me.sendMessageViaWebHook(\r\n      messageText,\r\n      (msgsData: any) => {\r\n        me.handleWebHookResponse(msgsData);\r\n      },\r\n      (err: any) => {\r\n        setTimeout(() => {\r\n          me.hideTypingIndicator();\r\n          $(`.kore-chat-window [data-time=\"${clientMessageId}\"]`).find('.messageBubble').append('<div class=\"errorMsg\">Send Failed. Please resend.</div>');\r\n        }, 350);\r\n      },\r\n      me.attachmentInfo ? { attachments: [me.attachmentInfo] } : null,\r\n    );\r\n  } else {\r\n    let chatWindowEvent = {stopFurtherExecution: false};\r\n    me.emit(me.EVENTS.BEFORE_WS_SEND_MESSAGE,{\r\n      messageToBot:messageToBot,\r\n      chatWindowEvent:chatWindowEvent\r\n    });\r\n    if(chatWindowEvent.stopFurtherExecution){\r\n      return false;\r\n    }\r\n    me.bot.sendMessage(messageToBot, (err: { message: any; }) => {\r\n      if (err && err.message) {\r\n        setTimeout(() => {\r\n          $(`.kore-chat-window [data-time=\"${clientMessageId}\"]`).find('.messageBubble').append('<div class=\"errorMsg\">Send Failed. Please resend.</div>');\r\n        }, 350);\r\n      }\r\n    });\r\n  }\r\n  \r\n  me.resetPingMessage();\r\n  me.postSendMessageToBot();\r\n  if(clientMessageObject){\r\n    me.extend(msgData,clientMessageObject);\r\n  }\r\n  me.renderMessage(msgData);\r\n};\r\n\r\npostSendMessageToBot () {\r\n  let me:any=this;\r\n  const _bodyContainer = $(me.chatEle).find('.kore-chat-body');\r\n  const _footerContainer = $(me.chatEle).find('.kore-chat-footer');\r\n  _footerContainer.find('.sendButton').addClass('disabled');\r\n  _bodyContainer.css('bottom', _footerContainer.outerHeight());\r\n\r\n  me.showTypingIndicator();\r\n  if (me.typingIndicatorTimer) {\r\n    clearTimeout(me.typingIndicatorTimer);\r\n  }\r\n  me.typingIndicatorTimer = setTimeout(() => {\r\n    me.hideTypingIndicator();\r\n  }, me.config.maxTypingIndicatorTime || 10000);\r\n}\r\n\r\nhandleWebHookResponse  (msgsData: any[]) {\r\n  let me:any=this;\r\n  const SUBSEQUENT_RENDER_DELAY = 500;\r\n  if (msgsData && msgsData.length) {\r\n    msgsData.forEach((msgData: any, index: number) => {\r\n      setTimeout(() => {\r\n        me.renderMessage(msgData);\r\n      }, (index >= 1) ? SUBSEQUENT_RENDER_DELAY : 0);\r\n    });\r\n  }\r\n};\r\n\r\nsendMessageViaWebHook  (message: { text: any; }, successCb: any, failureCB: any, options: { session: { new: boolean; }; attachments: any; }) {\r\n  const me:any = this;\r\n  if (me.config.botOptions.webhookConfig.webhookURL) {\r\n    const payload:any = {\r\n      session: {\r\n        new: false,\r\n      },\r\n      message: {\r\n        text: message,\r\n      },\r\n      from: {\r\n        id: me.config.botOptions.userIdentity,\r\n        userInfo: {\r\n          firstName: '',\r\n          lastName: '',\r\n          email: '',\r\n        },\r\n      },\r\n      to: {\r\n        id: 'Kore.ai',\r\n        groupInfo: {\r\n          id: '',\r\n          name: '',\r\n        },\r\n      },\r\n    };\r\n\r\n    if (me.config.botOptions.webhookConfig.apiVersion && me.config.botOptions.webhookConfig.apiVersion === 2) {\r\n      payload.message = {\r\n        type: 'text',\r\n        val: message,\r\n      };\r\n    }\r\n    if (typeof message === 'object') {\r\n      payload.message = message;\r\n    }\r\n    if (options && options.session) {\r\n      payload.session = options.session;\r\n    }\r\n    if (options && options.attachments) {\r\n      payload.message.attachments = options.attachments;\r\n    }\r\n\r\n    me.bot.sendMessageViaWebhook(payload, successCb, failureCB);\r\n  } else {\r\n    console.error('KORE:Please provide webhookURL in webhookConfig');\r\n  }\r\n};\r\n\r\ncloseConversationSession  () {\r\n  const me:any = this;\r\n  const clientMessageId = new Date().getTime();\r\n  const messageToBot:any = {};\r\n  messageToBot.clientMessageId = clientMessageId;\r\n  messageToBot.resourceid = '/bot.closeConversationSession';\r\n  bot.sendMessage(messageToBot, (err: any) => {\r\n    console.error('bot.closeConversationSession send failed sending');\r\n  });\r\n};\r\n\r\nshowTypingIndicator  () {\r\n  let me:any=this;\r\n  $('.typingIndicatorContent').css('display', 'block');\r\n};\r\nhideTypingIndicator  () {\r\n  $('.typingIndicatorContent').css('display', 'none');\r\n};\r\nrenderMessage  (msgData: { createdOnTimemillis: number; createdOn: string | number | Date; type: string; icon: any; message: { component: { payload: { fromHistory: any; }; }; }[]; messageId: any; renderType: string; fromHistorySync: any; } | any) {\r\n\r\n  let me:any = this;\r\n  let _chatContainer = $(me.chatEle).find('.chat-container');\r\n  let messageHtml=me.generateMessageDOM(msgData);\r\n  if(msgData?.createdOn){\r\n    msgData.createdOnTimemillis = new Date(msgData.createdOn).valueOf();\r\n  }\r\n\r\n  if (msgData?.type === 'bot_response') {\r\n    me.waiting_for_message = false;\r\n    setTimeout(() => {\r\n      $(me.chatEle).find('.typingIndicator').css('background-image', `url(${msgData.icon})`);\r\n    }, 500);\r\n    setTimeout(() => {\r\n      if (!me.waiting_for_message) {\r\n        if (me.typingIndicatorTimer) {\r\n          clearTimeout(me.typingIndicatorTimer);\r\n        }\r\n        me.hideTypingIndicator()\r\n      }\r\n    }, 500);\r\n  } else {\r\n    me.waiting_for_message = false;\r\n  }\r\n\r\n  if (!messageHtml && msgData && msgData.message && msgData.message[0]) {\r\n    // if (msgData.message[0] && msgData.message[0].component && msgData.message[0].component.payload && msgData.message[0].component.payload.template_type == 'button') {\r\n    //   messageHtml = $(me.getChatTemplate('templatebutton')).tmpl({\r\n    //     msgData,\r\n    //     helpers,\r\n    //     extension,\r\n    //   });\r\n    // } else \r\n    if (msgData.message[0] && msgData.message[0].component && msgData.message[0].component.payload && msgData.message[0].component.payload.template_type == 'wait_for_response') { // to show typing indicator until next response receive\r\n      me.waiting_for_message = true;\r\n      me.showTypingIndicator();\r\n      return;\r\n    } \r\n\r\n    //messageHtml=me.messageTemplate.renderMessage(msgData);\r\n    \r\n    // For Agent presence\r\n    if (msgData.type === 'bot_response') {\r\n      if (msgData.message[0] && msgData.message[0].component && msgData.message[0].component.payload && msgData.message[0].component.payload.template_type == 'live_agent') {\r\n        $('.kore-chat-window').addClass('agent-on-chat');\r\n      } else {\r\n        $('.kore-chat-window').removeClass('agent-on-chat');\r\n      }\r\n    }\r\n  }\r\n  _chatContainer.find('li').attr('aria-live', 'off');\r\n  // _chatContainer.find('li').attr('aria-hidden','true');//for mac voiceover bug with aria-live\r\n  let chatWindowEvent = {stopFurtherExecution: false};\r\n  me.emit(me.EVENTS.BEFORE_RENDER_MSG,{\r\n    messageHtml:messageHtml,\r\n    msgData:msgData,\r\n    chatWindowEvent:chatWindowEvent\r\n  });\r\n  if(chatWindowEvent.stopFurtherExecution){\r\n    return false;\r\n  }\r\n\r\n\r\n  // if (msgData && msgData.message[0] && msgData.message[0].component && msgData.message[0].component.payload && msgData.message[0].component.payload.sliderView && !msgData.message[0].component.payload.fromHistory) {\r\n  //   me.bottomSliderAction('show', messageHtml);\r\n  // } else {\r\n    // ignore message(msgId) if it is already in viewport\r\n  if ($(`.kore-chat-window .chat-container li#${msgData?.messageId}`).length < 1 || (msgData?.renderType === 'inline')) {\r\n    if (msgData?.type === 'bot_response' && msgData?.fromHistorySync) {\r\n      const msgTimeStamps: number[] = [];\r\n      const msgEles = $('.kore-chat-window .chat-container>li');\r\n      if (msgEles.length) {\r\n        msgEles.each((i: any, ele: any) => {\r\n          msgTimeStamps.push(parseInt($(ele).attr('data-time')));\r\n        });\r\n        const insertAtIndex = me.findSortedIndex(msgTimeStamps, msgData.createdOnTimemillis);\r\n\r\n        if (insertAtIndex > 0) {\r\n          const insertAfterEle = msgEles[insertAtIndex];\r\n          if (insertAfterEle) {\r\n            $(messageHtml).insertBefore(insertAfterEle);\r\n          } else {\r\n            _chatContainer.append(messageHtml);\r\n          }\r\n        } else {\r\n          _chatContainer.prepend(messageHtml);\r\n        }\r\n      } else {\r\n        _chatContainer.append(messageHtml);\r\n      }\r\n    } else {\r\n      if(bot && !bot.previousHistoryLoading){\r\n        _chatContainer.append(messageHtml);\r\n      }else{\r\n        $(this.paginatedScrollMsgDiv).find('.prev-message-list').append(messageHtml);\r\n      }\r\n\r\n    }\r\n  }\r\n  //}\r\n  me.handleImagePreview();\r\n\r\n  if (me.chatPSObj && me.chatPSObj.update) {\r\n    me.chatPSObj.update();\r\n  }\r\n  if(bot && !bot.previousHistoryLoading){\r\n  _chatContainer.animate({\r\n    scrollTop: _chatContainer.prop('scrollHeight'),\r\n  }, 100);\r\n  }\r\n  me.emit(me.EVENTS.AFTER_RENDER_MSG,{\r\n    messageHtml:messageHtml,\r\n    msgData:msgData\r\n  });\r\n};\r\n\r\ngenerateMessageDOM(msgData?:any){\r\n  const me:any = this; \r\n  let messageHtml = me.templateManager.renderMessage(msgData);\r\n  if (!messageHtml && msgData && msgData.message && msgData.message[0]) {\r\n    messageHtml=me.messageTemplate.renderMessage(msgData);\r\n  }\r\n  return messageHtml;\r\n}\r\n\r\npushTorenderMessagesQueue  (msgItem: any) {\r\n  const me:any = this;\r\n  if (!me.renderMessagesQueue) {\r\n    me.renderMessagesQueue = [];\r\n  }\r\n  me.renderMessagesQueue.push(msgItem);\r\n  if (!me.renderEventLoop) {\r\n    me.startRenderEventLoop();\r\n  }\r\n};\r\nstartRenderEventLoop  () {\r\n  const me:any = this;\r\n  me.msgRenderingProgress = false;\r\n  me.renderEventLoop = setInterval(() => {\r\n    console.log('Running Event loop');\r\n    me.checkForMsgQueue();\r\n  }, 500);\r\n};\r\ncheckForMsgQueue  () {\r\n  const me:any = this;\r\n  if (me.renderMessagesQueue.length && !me.msgRenderingProgress) {\r\n    const tempData = me.renderMessagesQueue.shift();\r\n    let delay = 0;\r\n    if (tempData?.message[0]?.component?.payload?.renderDelay) {\r\n      delay = tempData.message[0].component.payload.renderDelay || 0;\r\n    }\r\n    me.msgRenderingProgress = true;\r\n    setTimeout(() => {\r\n      me.renderMessage(tempData);\r\n      me.msgRenderingProgress = false;\r\n    }, delay);\r\n  }\r\n  if (!me.renderMessagesQueue.length && !me.msgRenderingProgress && me.renderEventLoop) {\r\n    clearTimeout(me.renderEventLoop);\r\n    me.renderEventLoop = false;\r\n  }\r\n};\r\n\r\n\r\nopenPopup  (link_url: any) {\r\n  const me:any = this;\r\n  const popupHtml = $(me.getChatTemplate('popup')).tmpl({\r\n    link_url,\r\n  });\r\n  $(me.config.container).append(popupHtml);\r\n  me.popupOpened = true;\r\n  me.bindIframeEvents($(popupHtml));\r\n};\r\n\r\nopenExternalLink  (link_url: any) {\r\n  const me:any = this;\r\n  const a = document.createElement('a');\r\n  $(me.config.container).append(a);\r\n  a.href = link_url;\r\n  a.target = '_blank';\r\n  a.rel = 'noopener noreferrer';// for tabnabbing security attack\r\n  a.click();\r\n  $(a).remove();\r\n};\r\n\r\ngetChatTemplate (tempType: string) {\r\n     var chatFooterTemplate =\r\n     '<div class=\"footerContainer pos-relative\"> \\\r\n         {{if userAgentIE}} \\\r\n         <div role=\"textbox\" class=\"chatInputBox inputCursor\" aria-label=\"Message\" aria-label=\"Message\" contenteditable=\"true\" placeholder=\"${botMessages.message}\"></div> \\\r\n         {{else}} \\\r\n         <div role=\"textbox\" class=\"chatInputBox\" contenteditable=\"true\" placeholder=\"${botMessages.message}\"></div> \\\r\n         {{/if}} \\\r\n     <div class=\"attachment\"></div> \\\r\n     {{if !(isSendButton)}}<div class=\"chatSendMsg\">${botMessages.entertosend}</div>{{/if}} \\\r\n </div>';\r\n\r\n var chatWindowTemplate = '<script id=\"chat_window_tmpl\" type=\"text/x-jqury-tmpl\"> \\\r\n     <div class=\"kore-chat-window droppable liteTheme-one\"> \\\r\n     <div class=\"kr-wiz-menu-chat defaultTheme-kore\">\\\r\n     </div>\t\\\r\n         <div class=\"minimized-title\"></div> \\\r\n         <div class=\"minimized\"><span class=\"messages\"></span></div> \\\r\n         <div class=\"kore-chat-header\"> \\\r\n             <div id=\"botHeaderTitle\" aria-labelledby=\"botHeaderTitle\" class=\"header-title\" title=\"${chatTitle}\">${chatTitle}</div> \\\r\n             <div class=\"chat-box-controls\"> \\\r\n                 {{if botMessages.availableLanguages}}\\\r\n                     <select class=\"lang-selector\" >\\\r\n                         {{each(key, lang) botMessages.availableLanguages}} \\\r\n                             <option  {{if botMessages.selectedLanguage===lang}}selected{{/if}} value=\"${lang}\">${lang}</option>\\\r\n                         {{/each}}\\\r\n                     </select>\\\r\n                 {{/if}}\\\r\n                 <button class=\"reload-btn\" title=\"${botMessages.reconnectText}\"></button> \\\r\n                 <button class=\"minimize-btn\" title=\"${botMessages.minimizeText}\"></button> \\\r\n                 <button class=\"expand-btn\" title=\"${botMessages.expandText}\"></button>\\\r\n                 <button class=\"close-btn\" title=\"${botMessages.expandText}\"></button> \\\r\n             </div> \\\r\n         </div> \\\r\n         <div class=\"kore-chat-header historyLoadingDiv\"> \\\r\n             <div class=\"historyWarningTextDiv displayTable\"> \\\r\n                 <span><img class = \"loadingHistory\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAAXNSR0IArs4c6QAAAYZJREFUOBGtVLFKA0EQfbMiiERQEgjpRQt/wULB/opIFCuJvb1iKdprbbASDaa4L9DCX7BQ7CVwQcEggph13t7t3RlivMKBsDsz701mZ9+eYNjaNyX0e9saDmCxZJv1mrQ6zxDcayxEqXyOxmo/TzN5B2fXDbxFT7D2VH9rgK3FeV3pM848cTnLirQ6e0q60lw1lx+11bziHD5Oi1tcZVfAkyIYOYRM3GF69gHvr4uwX8sY2AMFVDwIkA3srLcFnAFb9B2I3GJqchNbQTcDJ7uLsIqPz0s91koS6WKmMm+SIfojRL8WIIuF+QdAlBSpks+ZBEkA7gijOkgBumGeR80sMLzG1OcMilgep3wDseWUxyEWsTnzmMKUr51ILw3wForYy2AhhSlfO3FKjGO8xiKWxymfgw1THnXAaxxnzMd68ajQuLcAeE1UnA5+K+R1kgmuS/4/KdY3xbdgB0fe/XMVs49m/Zi4uBPPiN/Qibrj5qJHl12+GU/7WYTRoe+J0xFlMOZ78g1n4achujvX7QAAAABJRU5ErkJggg==\"></span> \\\r\n                 <p class=\"headerTip warningTip\">${botMessages.loadinghistory}</p> \\\r\n             </div> \\\r\n         </div> \\\r\n         <div class=\"kore-chat-header trainWarningDiv\"> \\\r\n             <div class=\"trainWarningTextDiv displayTable\"> \\\r\n                 <span class=\"exclamation-circle\"><i class=\"fa fa-exclamation-circle\" aria-hidden=\"true\"></i></span> \\\r\n                 <p class=\"headerTip warningTip\">Something went wrong.Please try again later.</p> \\\r\n             </div> \\\r\n         </div> \\\r\n         <div role=\"log\" aria-live=\"polite\" aria-atomic=\"true\" class=\"kore-chat-body\"> \\\r\n             <div class=\"errorMsgBlock\"> \\\r\n             </div> \\\r\n             <ul class=\"chat-container\"></ul> \\\r\n         </div> \\\r\n         <div class=\"typingIndicatorContent\"><div class=\"typingIndicator\"></div><div class=\"movingDots\"></div></div> \\\r\n         <div class=\"kore-chat-footer disableFooter\">' + chatFooterTemplate + '{{if isSendButton}}<div class=\"sendBtnCnt\"><button class=\"sendButton disabled\" type=\"button\">${botMessages.sendText}</button></div>{{/if}}</div> \\\r\n          <div id=\"myModal\" class=\"modalImagePreview\">\\\r\n               <span class=\"closeImagePreview\">&times;</span>\\\r\n               <img class=\"modal-content-imagePreview\" id=\"img01\">\\\r\n               <div id=\"caption\"></div>\\\r\n         </div>\\\r\n         <div id=\"chatBodyModal\" class=\"chatBodyModal animate-bottom\">\\\r\n         <span class=\"closeChatBodyModal\" aira-label=\"Close Form\" role=\"button\" tabindex=\"0\" aria-atomic=\"true\"></span>\\\r\n         <div id=\"closeInlineModel\" class=\"loading_form iframeLoader\"></div>\\\r\n         <div id=\"chatBodyModalContent\"></div>\\\r\n         </div>\\\r\n         <div id=\"myPreviewModal\" class=\"modalImagePreview\">\\\r\n               <span class=\"closeElePreview\">&times;</span>\\\r\n               <div class=\"largePreviewContent\"></div>\\\r\n         </div>\\\r\n         <div class=\"kr-wiz-content-chat defaultTheme-kore\">\\\r\n         </div>\\\r\n     </div> \\\r\n </script>';\r\n var popupTemplate = '<script id=\"kore_popup_tmpl\" type=\"text/x-jquery-tmpl\"> \\\r\n         <div class=\"kore-auth-layover\">\\\r\n             <div class=\"kore-auth-popup\"> \\\r\n                 <div class=\"popup_controls\"><span class=\"close-popup\" title=\"Close\">&times;</span></div> \\\r\n                 <iframe id=\"authIframe\" src=\"${link_url}\"></iframe> \\\r\n             </div> \\\r\n         </div>\\\r\n </script>'; \r\n if (tempType === \"popup\") {\r\n     return popupTemplate;\r\n } \r\n else {\r\n     return chatWindowTemplate;\r\n }\r\n };\r\n\r\nhistoryLoadingComplete () {\r\n  const me:any = this;\r\n  const _chatContainer = me.chatEle;\r\n  setTimeout((me) => {\r\n    $('.chatInputBox').focus();\r\n    $('.disableFooter').removeClass('disableFooter');\r\n    me.historyLoading = false;\r\n    if (me.config && me.config && me.config.botOptions && me.config.botOptions.webhookConfig && me.config.botOptions.webhookConfig.enable) {\r\n      me.getBotMetaData();\r\n    }\r\n    if ($(this.paginatedScrollMsgDiv).find('.prev-message-list li').length > 0 && bot.previousHistoryLoading) {\r\n      let paginatedLi = $(this.paginatedScrollMsgDiv).find('.prev-message-list li');\r\n      if (paginatedLi && paginatedLi.length) {\r\n        for (var i = 0; i < paginatedLi.length; i++) {\r\n          var tempLi = $(paginatedLi[i]);\r\n          tempLi.addClass('no-animate-messge-bubble')\r\n        }\r\n      }\r\n      let _existingLi = $(this.paginatedScrollMsgDiv).find('.prev-message-list li');\r\n      $(this.paginatedScrollMsgDiv).find('.prev-message-list li').insertBefore(_chatContainer.find('.chat-container li:first'));\r\n      let _heightTobeScrolled = 0;\r\n      if (_existingLi && _existingLi.length) {\r\n        for (var i = 0; i < _existingLi.length; i++) {\r\n          var tempLi = $(_existingLi[i]);\r\n          _heightTobeScrolled = _heightTobeScrolled + tempLi.height();\r\n        }\r\n      }\r\n      _chatContainer.find('.chat-container').scrollTop(_heightTobeScrolled);\r\n      $(this.paginatedScrollMsgDiv).find('.prev-message-list').empty();\r\n      _chatContainer.find('.paginted-history-loader').remove();\r\n      bot.previousHistoryLoading = false;\r\n    }\r\n  }, 0, me);\r\n};\r\n\r\nchatHistory  (res: { messages: string | any[]; }[] | any) {\r\n  const me:any = this;\r\n  let chatWindowEvent = {stopFurtherExecution: false};\r\n  me.emit(me.EVENTS.ON_CHAT_HISTORY_RESPONSE,{\r\n    historyResponse:res,\r\n    chatWindowEvent:chatWindowEvent\r\n  });\r\n  if(chatWindowEvent.stopFurtherExecution){\r\n    return false;\r\n  }\r\n  if (res[2] === 'historysync') {\r\n    // setTimeout(function () {\r\n    if (res && res[1] && res[1].messages.length > 0) {\r\n      res[1].messages.forEach((msgData: { type: string; fromHistorySync: boolean; }, index: number) => {\r\n        setTimeout(() => {\r\n          if (msgData.type === 'outgoing' || msgData.type === 'bot_response') {\r\n            // if ($('.kore-chat-window .chat-container li#' + msgData.messageId).length < 1) {\r\n            msgData.fromHistorySync = true;\r\n            me.renderMessage(msgData);\r\n            // }\r\n          }\r\n        }, index * 100);\r\n      });\r\n    }\r\n    // }, 4000);//sync history messages after sockeet messages gets into viewport\r\n  } else if (me.loadHistory) {\r\n    me.historyLoading = true;\r\n    if (res && res[1] && res[1].messages.length > 0) {\r\n      if(!bot.previousHistoryLoading){\r\n        $('.chat-container').hide();\r\n        $('.historyLoadingDiv').addClass('showMsg');\r\n      }\r\n      res[1].messages.forEach((msgData: { messageId: any; message: { cInfo: { body: string; }; }[]; } | any, index: number) => {\r\n        setTimeout((messagesQueue) => {\r\n         \r\n          const _ignoreMsgs = messagesQueue.filter((queMsg: { messageId: any; }) => queMsg?.messageId === msgData?.messageId);\r\n          // dont show the the history message if we already have same message came from socket connect\r\n          if (!_ignoreMsgs.length) {\r\n            msgData.fromHistory=true;\r\n            try {\r\n              msgData.message[0].cInfo.body = JSON.parse(msgData.message[0].cInfo.body);\r\n              if (msgData.message[0].cInfo.body && msgData.message[0].cInfo.body.text) {\r\n                msgData.message[0].cInfo.body = msgData.message[0].cInfo.body.text;\r\n              }\r\n              msgData.message[0].component = msgData.message[0].cInfo.body;\r\n              if (msgData.message[0].component.payload.template_type === 'dropdown_template') {\r\n                msgData.message[0].component.payload.fromHistory = true;\r\n                msgData.message[0].component.selectedValue = res[1].messages[index + 1].message[0].cInfo.body;\r\n              }\r\n              if (msgData.message[0].component.payload.template_type === 'multi_select' || msgData.message[0].component.payload.template_type === 'advanced_multi_select') {\r\n                msgData.message[0].component.payload.fromHistory = true;\r\n              }\r\n              if (msgData.message[0].component.payload.template_type === 'form_template') {\r\n                msgData.message[0].component.payload.fromHistory = true;\r\n              }\r\n              if (msgData.message[0].component.payload.template_type === 'tableList') {\r\n                msgData.message[0].component.payload.fromHistory = true;\r\n              }\r\n              if (msgData.message[0].component.payload.template_type === 'listView') {\r\n                msgData.message[0].component.payload.fromHistory = true;\r\n              }\r\n              // if (msgData.message[0].component.payload.template_type === 'feedbackTemplate') {\r\n              //     msgData.message[0].component.payload.fromHistory = true;\r\n              //     msgData.message[0].cInfo.body=\"Rate this chat session\";\r\n              // }\r\n              if (msgData.message[0].component && msgData.message[0].component.payload && (msgData.message[0].component.payload.videoUrl || msgData.message[0].component.payload.audioUrl)) {\r\n                msgData.message[0].cInfo.body = '';\r\n              }\r\n              me.renderMessage(msgData);\r\n            } catch (e) {\r\n              me.renderMessage(msgData);\r\n            }\r\n          }\r\n          if (index === res[1].messages.length - 1) {\r\n            setTimeout((messagesQueue) => {\r\n              $('.chat-container').show();\r\n              $('.historyLoadingDiv').removeClass('showMsg');\r\n              if(!bot.previousHistoryLoading){\r\n                  $('.chat-container').animate({\r\n                    scrollTop: $('.chat-container').prop('scrollHeight'),\r\n                  }, 2500);\r\n                  $('.chat-container').append(\"<div class='endChatContainer'><span class='endChatContainerText'>End of chat history</span></div>\");\r\n              }\r\n              if (messagesQueue.length) {\r\n                messagesQueue.forEach((msg: any, currIndex: number) => {\r\n                  me.renderMessage(msg);\r\n                  if (messagesQueue.length - 1 === currIndex) {\r\n                    messagesQueue = [];\r\n                    me.historyLoadingComplete();\r\n                  }\r\n                });\r\n              } else {\r\n                me.historyLoadingComplete();\r\n              }\r\n            }, 500, messagesQueue);\r\n          }\r\n        }, index * 100, me.messagesQueue);\r\n      });\r\n    } else {\r\n      me.historyLoadingComplete();\r\n    }\r\n  }\r\n};\r\n\r\ngetJWTByAPIKey (API_KEY_CONFIG: { KEY: any; bootstrapURL: any; }) {\r\n  const jsonData = {\r\n    apiKey:API_KEY_CONFIG.KEY\r\n  };\r\n  return $.ajax({\r\n    url: API_KEY_CONFIG.bootstrapURL||'https://bots.kore.ai/api/platform/websdk',\r\n    type: 'post',\r\n    data: jsonData,\r\n    dataType: 'json',\r\n    success(data: any) {\r\n    },\r\n    error(err: any) {\r\n      // chatWindowInstance.showError(err.responseText);\r\n    },\r\n  });\r\n};\r\n\r\ngetJWT (options: { clientId: any; clientSecret: any; userIdentity: any; JWTUrl: any; }, callback: any) {\r\n  const jsonData = {\r\n    clientId: options.clientId,\r\n    clientSecret: options.clientSecret,\r\n    identity: options.userIdentity,\r\n    aud: '',\r\n    isAnonymous: false,\r\n  };\r\n  return $.ajax({\r\n    url: options.JWTUrl,\r\n    type: 'post',\r\n    data: jsonData,\r\n    dataType: 'json',\r\n    success(data: any) {\r\n\r\n    },\r\n    error(err: any) {\r\n      // chatWindowInstance.showError(err.responseText);\r\n    },\r\n  });\r\n};\r\n\r\nJWTSetup (){\r\n  let me:any=this;\r\n  me.config.botOptions.assertionFn = me.assertionFn.bind(me);\r\n  if(!(me.config && me.config.JWTAsertion)){\r\n    if(me.config && me.config.botOptions.API_KEY_CONFIG && me.config.botOptions.API_KEY_CONFIG.KEY && me.config.botOptions.API_KEY_CONFIG.KEY!='YOUR_API_KEY'){\r\n      me.setupInternalAssertionFunctionWithAPIKey();\r\n    }else{\r\n      me.setupInternalAssertionFunction();\r\n    }\r\n\r\n  } \r\n}\r\nsetupInternalAssertionFunction (){\r\n  const me:any = this;\r\n  me.getJWT(me.config.botOptions).then(function(res: { jwt: any; }){\r\n    me.emit(me.EVENTS.JWT_SUCCESS, res);\r\n    me.setJWT(res.jwt);\r\n    if(me.config.botOptions.callback){\r\n      me.config.botOptions.callback(null, me.config.botOptions);\r\n    }\r\n  },function(errRes: any){\r\n      console.log(errRes);\r\n  });\r\n}\r\n\r\nsetupInternalAssertionFunctionWithAPIKey (){\r\n  const me:any = this;\r\n  me.getJWTByAPIKey(me.config.botOptions.API_KEY_CONFIG).then(function(res: { botInfo: { name: any; _id: any; }; ity: any; jwt: any; }){\r\n    if(me.config.widgetSDKInstace && res.botInfo){\r\n      var widgetsConfig=me.config.widgetSDKInstace.config;\r\n      widgetsConfig.botOptions.botInfo.name=res.botInfo.name;\r\n      widgetsConfig.botOptions.botInfo._id=res.botInfo._id;\r\n      widgetsConfig.botOptions.userIdentity=res.ity;\r\n    }\r\n    me.emit(me.EVENTS.JWT_SUCCESS, res);\r\n    me.setJWT(res.jwt);\r\n    if(res.botInfo){\r\n      me.config.chatTitle = me.config.botOptions.botInfo.chatBot=res.botInfo.name;\r\n      me.config.botOptions.botInfo.taskBotId=res.botInfo._id;\r\n    }\r\n    me.config.botOptions.callback(null, me.config.botOptions);\r\n  },function(errRes: any){\r\n      console.log(errRes);\r\n  });\r\n}\r\n\r\nsetJWT  (jwtToken: any) {\r\n  const me:any = this;\r\n  const options = me.config.botOptions;\r\n  options.assertion = jwtToken;\r\n};\r\nassertionFn (options:any, callback:any) {\r\n  const me:any = this;\r\n  options.callback = callback;\r\n  options.handleError = me.showError;\r\n  options.chatHistory = me.chatHistory.bind(me);\r\n  options.botDetails = me.botDetails;\r\n  if(me.config && me.config.JWTAsertion){\r\n    me.config.JWTAsertion(me.SDKcallbackWraper.bind(me));\r\n  }else if(options.assertion){//check for reconnect case\r\n    if(me.config && me.config.botOptions.API_KEY_CONFIG && me.config.botOptions.API_KEY_CONFIG.KEY!='YOUR_API_KEY'){\r\n      me.setupInternalAssertionFunctionWithAPIKey();\r\n    }else{\r\n      me.setupInternalAssertionFunction();\r\n    }\r\n  }\r\n};\r\nSDKcallbackWraper () {\r\n  const me:any = this;\r\n  me.config.botOptions.callback(null, me.config.botOptions);\r\n}\r\n\r\naddWidgetEvents  (cfg:any) {\r\n  let me:any=this;\r\n  if (cfg) {\r\n    var wizSDK = cfg.widgetSDKInstace;\r\n    wizSDK.events.onPostback = function (data:any) { \r\n      me.sendMessageToBot(data.payload,{renderMsg:data.utterance});\r\n    };\r\n  }\r\n};\r\n\r\nsetWidgetInstance  (widgetSDKInstace:any) {\r\n  let me:any=this;\r\n  if (widgetSDKInstace) {\r\n    me.config.widgetSDKInstace = widgetSDKInstace;\r\n    me.addWidgetEvents(me.config);\r\n  }\r\n};\r\n\r\n\r\nhideError  () {\r\n  $('.errorMsgBlock').removeClass('showError');\r\n};\r\nshowError (response:any) {\r\n  try {\r\n    response = JSON.parse(response);\r\n    if (response.errors && response.errors[0]) {\r\n      $('.errorMsgBlock').text(response.errors[0].msg);\r\n      $('.errorMsgBlock').addClass('showError');\r\n    }\r\n  } catch (e) {\r\n    $('.errorMsgBlock').text(response);\r\n    $('.errorMsgBlock').addClass('showError');\r\n  }\r\n};\r\n\r\nbottomSliderAction  (action:any, appendElement:any) {\r\n  $(\".kore-action-sheet\").animate({ height: 'toggle' });\r\n  if (action == 'hide') {\r\n    $(\".kore-action-sheet\").innerHTML = '';\r\n    $(\".kore-action-sheet\").addClass(\"hide\");\r\n  } else {\r\n    $(\".kore-action-sheet\").removeClass(\"hide\");\r\n    $(\".kore-action-sheet .actionSheetContainer\").empty();\r\n    setTimeout(function () {\r\n      $(\".kore-action-sheet .actionSheetContainer\").append(appendElement);\r\n    }, 200);\r\n\r\n  }\r\n}\r\n\r\nunfreezeUIOnHistoryLoadingFail () {\r\n  const me:any = this;\r\n  setTimeout((me) => {\r\n    if (me.loadHistory) {\r\n      $('.chatInputBox').focus();\r\n      $('.disableFooter').removeClass('disableFooter');\r\n      me.historyLoading = false;\r\n    }\r\n  }, 20000, me);\r\n};\r\n\r\n\r\ninstallPlugin  (plugin:any) {\r\n  const me:any = this;\r\n  me.plugins[plugin.name] = plugin;\r\n  plugin.hostInstance = this; \r\n  if(plugin.onHostCreate) { \r\n    plugin.onHostCreate();\r\n  }\r\n};\r\nscrollTop  () {\r\n  const me:any = this;\r\n  const _chatContainer = me.chatEle;\r\n  _chatContainer.scrollTop($('.chat-container').prop('scrollHeight'));\r\n};\r\nfocusInputTextbox () {\r\n  const me:any = this;\r\n  const _chatContainer = me.chatEle;\r\n  setTimeout(() => {\r\n    const _chatInput = _chatContainer.find('.kore-chat-footer .chatInputBox');\r\n    _chatInput.focus();\r\n  }, 600);\r\n};\r\ngetBrandingInformation(options:any){\r\n  let me:any = this;\r\n  if (me.config && me.config.enableThemes) {\r\n      if(!me.config.botOptions.brandingAPIUrl){\r\n          me.config.botOptions.brandingAPIUrl = me.config.botOptions.koreAPIUrl +'websdkthemes/'+  me.config.botOptions.botInfo.taskBotId+'/activetheme';\r\n      }\r\n      var brandingAPIUrl = (me.config.botOptions.brandingAPIUrl || '').replace(':appId', me.config.botOptions.botInfo.taskBotId);\r\n      $.ajax({\r\n          url: brandingAPIUrl,\r\n          type: 'get',\r\n          headers: {\r\n            'Authorization': \"bearer \" + options.authorization.accessToken,\r\n          },\r\n          dataType: 'json',\r\n          success: function (data: any) {  \r\n                  me.applySDKBranding(data);\r\n          },\r\n          error: function (err: any) {\r\n              console.log(err);\r\n          }\r\n      });\r\n  }\r\n\r\n}\r\napplySDKBranding  (response:any) {\r\n  const me:any = this;\r\n  if (response && response.activeTheme) {\r\n      for (var key in response) {\r\n      switch (key){\r\n          case 'generalAttributes':\r\n          if(key  && typeof response[key] === 'object') {\r\n              for (var property in response[key]){\r\n                me.applyVariableValue(property,response[key][property],key);\r\n              }\r\n          }\r\n          break;\r\n          case 'botMessage':\r\n          if(key  && typeof response[key] === 'object') {\r\n              for (var property in response[key]){\r\n                me.applyVariableValue(property,response[key][property],key);\r\n              }\r\n          }\r\n          break;\r\n          case 'userMessage':\r\n          if(key  && typeof response[key] === 'object') {\r\n              for (var property in response[key]){\r\n                me.applyVariableValue(property,response[key][property],key);\r\n              }\r\n          }\r\n          break;\r\n          case 'widgetHeader':\r\n          if(key  && typeof response[key] === 'object') {\r\n              for (var property in response[key]){\r\n                me.applyVariableValue(property,response[key][property],key);\r\n              }\r\n          }\r\n          break;\r\n          case 'widgetFooter':\r\n          if(key  && typeof response[key] === 'object') {\r\n              for (var property in response[key]){\r\n                me.applyVariableValue(property,response[key][property],key);\r\n              }\r\n          }\r\n          break;\r\n          case 'widgetBody':\r\n          if(key  && typeof response[key] === 'object') {\r\n              for (var property in response[key]){\r\n                  if(property === 'backgroundImage' && response[key] && response[key]['useBackgroundImage']){\r\n                      $(\".kore-chat-body\").css(\"background-image\", \"url(\" + response[key]['backgroundImage'] + \")\");\r\n                  } else {\r\n                    me.applyVariableValue(property,response[key][property],key);\r\n                  }\r\n              }\r\n          }\r\n          case 'buttons':\r\n              if(key  && typeof response[key] === 'object') {\r\n                  for (var property in response[key]){\r\n                    me.applyVariableValue(property,response[key][property],key);\r\n                  }\r\n              }\r\n          break;\r\n          case 'digitalViews':\r\n              var defaultTheme = 'defaultTheme-kore';\r\n              if(response && response[key] && response[key].panelTheme){\r\n                var digitalViewsThemeMapping:any = {\r\n                    'theme_one':\"defaultTheme-kore\",\r\n                    'theme_two':\"darkTheme-kore\",\r\n                    'theme_three':\"defaultTheme-kora\",\r\n                    'theme_four':\"darkTheme-kora\"\r\n                }\r\n                if(digitalViewsThemeMapping[response[key].panelTheme]){\r\n                  defaultTheme = digitalViewsThemeMapping[response[key].panelTheme];\r\n                  $('.kr-wiz-menu-chat').addClass(defaultTheme);\r\n                  $('.kr-wiz-menu-chat').removeClass('defaultTheme-kore');\r\n                  \r\n                }\r\n              }\r\n          default:\r\n          break;\r\n      }\r\n     }\r\n      $(\".kore-chat-window\").addClass('customBranding-theme');\r\n  }\r\n};\r\napplyVariableValue (key:any,value:any,type:any){\r\n  try{\r\n      var cssPrefix = \"--sdk-chat-custom-\";\r\n      var cssVariable = \"\";\r\n      cssVariable = cssPrefix + '-' + type +'-' +key;\r\n      //  console.log(cssVariable+\":\",value);\r\n      if(value === 'square'){\r\n          value = '12px 12px 2px 12px'\r\n      }else if(value === 'circle'){\r\n          value = '20px 20px 20px 20px'\r\n      }\r\n      if(cssVariable){\r\n          document.documentElement.style.setProperty(cssVariable, value);\r\n      }\r\n  } catch(e){\r\n      console.log(e);\r\n  }\r\n  \r\n}\r\n\r\n/**\r\n * [#]{@link chatWindow#sendMessage} Send message to bot including rendering \r\n * @param {String} messageText message text to send\r\n * @param {Object} [options] additional options\r\n * @param {Object} options.renderMsg override message to show in UI\r\n * @param {Object} [serverMessageObject] overrides the properties of message object before sending to websocket\r\n * @param {Object} serverMessageObject.customdata customdata to send bot\r\n * @param {Object} serverMessageObject.message.metaTags metaTags to send bot\r\n * @param {Object} serverMessageObject.message.nlMeta nlMeta to send bot\r\n * @param {Object} [clientMessageObject] overrides the properties of message object before sending to UI renderMessage method\r\n * @param {Object} clientMessageObject.createdOn customdata to send bot\r\n * @param {Object} clientMessageObject.message.clientMessageId metaTags to send bot\r\n * @param {Object} clientMessageObject.message.cInfo.body nlMeta to send bot\r\n * @param clientMessageObject.____ and more\r\n*/\r\nsendMessage (messageText:any,options:any, serverMessageObject:any,clientMessageObject:any) {\r\n  const me:any = this;\r\n  me.sendMessageToBot(messageText, options, serverMessageObject,clientMessageObject);\r\n};\r\n  \r\n}\r\n(chatWindow.prototype as any).$ = $;\r\n\r\nexport default chatWindow;\r\n","__webpack_require__.h = () => (\"7a8e164bdfb3ffbb72fc\")"],"names":[],"sourceRoot":""}
