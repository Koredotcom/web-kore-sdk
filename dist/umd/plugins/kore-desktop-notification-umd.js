!function(o,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.KoreDesktopNotificationPluginSDK=t():o.KoreDesktopNotificationPluginSDK=t()}(self,(()=>(()=>{"use strict";var o={d:(t,e)=>{for(var i in e)o.o(e,i)&&!o.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},o:(o,t)=>Object.prototype.hasOwnProperty.call(o,t),r:o=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})}},t={};o.r(t),o.d(t,{KoreDesktopNotificationPlugin:()=>i});var e=function(){return e=Object.assign||function(o){for(var t,e=1,i=arguments.length;e<i;e++)for(var n in t=arguments[e])Object.prototype.hasOwnProperty.call(t,n)&&(o[n]=t[n]);return o},e.apply(this,arguments)};const i=function(){function o(o){this.name="KoreDesktopNotificationPlugin ",this.config={},this.isOutTabFocus=!1,this.config=e(e({},this.config),o)}return o.prototype.onHostCreate=function(){var o=this,t=this;t.hostInstance.on("jwtGrantSuccess",(function(e){t.onInit(),o.config=t.extend(t,e)}))},o.prototype.onInit=function(){"default"===Notification.permission&&Notification.requestPermission(),window.addEventListener("blur",(function(){o.isOutTabFocus=!0})),window.addEventListener("focus",(function(){o.isOutTabFocus=!1}));var o=this;this.appendVideoAudioElemnts(),o.hostInstance.on("onWSMessage",(function(t){var e,i,n,a,s,r,d,u,l,p,c,f;"agent_connected"===(null===(i=null===(e=t.messageData)||void 0===e?void 0:e.message)||void 0===i?void 0:i.type)&&new Audio("https://uat.kore.ai/agents/sounds/Basic%20Alert%20High.mp3").play();if("bot_response"===t.messageData.type&&(null===(d=null===(r=null===(s=null===(a=null===(n=t.messageData)||void 0===n?void 0:n.message[0])||void 0===a?void 0:a.component)||void 0===s?void 0:s.payload)||void 0===r?void 0:r.payload)||void 0===d?void 0:d.text)){if("granted"!==Notification.permission)return;var v,y={body:null===(f=null===(c=null===(p=null===(l=null===(u=t.messageData)||void 0===u?void 0:u.message[0])||void 0===l?void 0:l.component)||void 0===p?void 0:p.payload)||void 0===c?void 0:c.payload)||void 0===f?void 0:f.text,vibrate:[200,100,200],sound:"/home/vishalveerannapet/kore/desktop-notification/web-kore-sdk/src/plugins/desktopNotifications/Desktop Notification sdk.mp3",requireInteraction:!1,onclick:function(o){o.target.close()}};if(o.isOutTabFocus)v=new Notification("You have a new notification ",y),new Audio("https://uat.kore.ai/agents/sounds/Basic%20Alert%20High.mp3").play();v&&(v.onclick=function(o){window.parent.focus(),v.close()})}}))},o.prototype.appendVideoAudioElemnts=function(){var o=this.hostInstance.chatEle;o.append('<video id="kore_local_video" autoplay="autoplay" playsinline style="width:0px;height:0px"></video>'),o.append('<video id="kore_remote_video" autoplay="autoplay" playsinline style="width:0px;height:0px"></video>')},o.prototype.extend=function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]&&"object"==typeof t[e]?this.extend(o[e],t[e]):o[e]=t[e]);return o},o}();return t})()));